load(httprequest("https://raw.githubusercontent.com/dailybgl/GrowPai-SCRIPTS/main/useridDB.lua","get"))()
local startscript = false
for key,value in pairs(uid) do
    if value == GetLocal().userid then
        startscript = true
    end
end
local function log(str)
    local var = {}
    var[0] = "OnConsoleMessage"
    var[1] = "`#[`bDailyBGL`#] `c"..str
    var.netid = -1
    SendVarlist(var)
end
if startscript then
RemoveCallbacks()
    local magindex = 1
    local reconnect_type = 1
    local tilecount = 0
    local do_ptht = false
    local do_auto = true
    local world_200x200 = false
    local item_break_weared = false
    local item_harvest_weared = false
    local magpositionx = 0
    local magpositiony = 0
    local getWear = true
    local side = "right"
    local function Wrench(x, y)
        local pkt = {}
        pkt.type = 3
        pkt.int_data = 32
        pkt.int_x = x
        pkt.int_y = y
        pkt.pos_x = GetLocal().pos_x
        pkt.pos_y = GetLocal().pos_y
        SendPacketRaw(pkt)
    end
    local function Punch(x, y)
        local pkt = {}
        pkt.type = 3
        pkt.int_data = 18
        pkt.pos_x = GetLocal().pos_x
        pkt.pos_y = GetLocal().pos_y
        pkt.int_x = x
        pkt.int_y = y
        pkt.flags = 16
        Sleep(50)
        SendPacketRaw(pkt)
    end
    function faceSide(sides)
        if sides == "left" then
            packet = {}
            packet.type = 0
            packet.pos_x = GetLocal().pos_x
            packet.pos_y = GetLocal().pos_y
            packet.flags = 50
            SendPacketRaw(packet)
            return
        elseif sides == "right" then
            packet = {}
            packet.type = 0
            packet.pos_x = GetLocal().pos_x
            packet.pos_y = GetLocal().pos_y
            packet.flags = 34
            SendPacketRaw(packet)
            return
        end
        log("cInvalid side chosen (4" .. sides .. "`c)")
    end
    local function Place(x,y,itemid)
        local pkt = {}
        pkt.type = 3
        pkt.int_data = itemid
        pkt.pos_x = GetLocal().pos_x
        pkt.pos_y = GetLocal().pos_y
        pkt.int_x = x
        pkt.int_y = y
        SendPacketRaw(pkt)
    end
    local function Wear(id)
        local pkt = {}
        pkt.type = 10 
        pkt.int_data = id
        SendPacketRaw(pkt)
    end
    local function callRayman()
        local pkt = {}
        pkt.type = 0 
        pkt.objtype = 0 
        pkt.count1 = 0 
        pkt.count2 = 0 
        pkt.netid = 0 
        pkt.item = 0 
        pkt.float1 = 0.00
        pkt.int_data = 0
        pkt.int_x = -1
        pkt.int_y = -1
        pkt.flags = 16779298
        SendPacketRaw(pkt)
    end
    local function warn(str)
        local var = {}
        var[0] = "OnAddNotification"
        var[1] = "interface/atomic_button.rttex"
        var[2] = "Warning from `4System``: "..str.."``"
        var[3] = "audio/hub_open.wav"
        var.netid = -1
        SendVarlist(var)
    end
    local function Recon()
        while GetLocal().world ~= string.upper(world_auto) do
            Sleep(10000)
            log("Disconnected..")
            SendPacket(3, "action|join_request\nname|"..world_auto.."\ninvitedWorld|0\n")
            Sleep(10000)
            if GetLocal().world_auto == string.upper(world_auto) then
                log("Reconnected")
            end
        end
        local hasmag = false
        for _, item in pairs(GetInventory()) do
            if item.id == 5640 then
                hasmag = true
                break
            end
        end
        if not hasmag then
            local mag_pos_x, mag_pos_y
            if reconnect_type == 1 then
                if world_200x200 then
                    if magindex == 1 then
                        mag_pos_x, mag_pos_y = magposX_block_island_1, magposY_block_island_1
                    elseif magindex == 2 then
                        mag_pos_x, mag_pos_y = magposX_block_island_2, magposY_block_island_2
                    end
                else
                    mag_pos_x, mag_pos_y = magposX_block, magposY_block
                end
            else
                mag_pos_x, mag_pos_y = magposX_seed, magposY_seed
            end
            FindPath(mag_pos_x, mag_pos_y-1)
            Sleep(1000)
            Wrench(mag_pos_x, mag_pos_y)
            Sleep(1000)
            SendPacket(2, "action|dialog_return\ndialog_name|magplant_edit\nx|"..mag_pos_x.."|\ny|"..mag_pos_y.."|\nbuttonClicked|getRemote\n")
            Sleep(500)
            if reconnect_type == 1 then
                FindPath(pos_break_x,pos_break_y)
                Sleep(500)
                SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autofarm|1\ncheck_bfg|1\ncheck_gems|"..collect_gems)
                Sleep(500)
            end
        end
    end
    local function count_tiles(item_id, ready_only)
        local world = GetLocal().world
        if world ~= string.upper(world_auto) then
            return 1
        end
        local count = 0
        local tiles = world_200x200 and {width = 199, height = 193} or {width = 99, height = 53}
        for y = 0, tiles.height do
            for x = 0, tiles.width do
                local tile = GetTile(x,y)
                if tile.fg == item_id and (not ready_only or tile.ready) then
                    count = count + 1
                end
            end
        end
        return count
    end
    local function count_tiles2(item_id)
        local world = GetLocal().world
        if world ~= string.upper(world_auto) then
            return 1
        end
        local count = 0
        local tiles = world_200x200 and {width = 199, height = 193} or {width = 99, height = 53}
        for y = 0, tiles.height do
            for x = 0, tiles.width do
                local tile = GetTile(x,y)
                if tile.fg == item_id then
                    count = count + 1
                end
            end
        end
        return count
    end
    AddCallback("SDBHOOK", "OnVarlist",function(varlist, packet)
        if varlist[0]:find("OnSDBroadcast") then
            return true
        end
    end)
    AddCallback("MHOOK", "OnVarlist",function(varlist, packet)
        if varlist[0]:find("OnDialogRequest") and varlist[1]:find("end_dialog|magplant_edit") then
            local matchx = varlist[1]:match("embed_data|x|(%d+)")
            local matchy = varlist[1]:match("embed_data|y|(%d+)")
            magpositionx = tonumber(matchx)
            magpositiony = tonumber(matchy)
            if varlist[1]:find("add_label|small|Building mode: `6DISABLED``") then
                return true
            end
            local matches = varlist[1]:match("`w(%d+)`` items")
            local magcount = tonumber(matches)
            log("Total item in magplant : "..magcount)
            return true
        end
    end)
    AddCallback("DETECTEMPTY", "OnVarlist", function(varlist, packet)
        if varlist[0]:find("OnTalkBubble") and varlist[2]:find("The MAGPLANT 5000 is empty.") then
            if world_200x200 then
                if magpositionx == magposX_block_island_1 and magpositiony == magposY_block_island_1 then
                    log("MAGPLANT EMPTY")
                    do_auto = true
                    do_ptht = false
                    magindex = 2
                    return true
                elseif magpositionx == magposX_block_island_2 and magpositiony == magposY_block_island_2 then
                    log("MAGPLANT EMPTY")
                    do_auto = false
                    do_ptht = true
                    magindex = 1
                    return true
                end
            end
            log("MAGPLANT EMPTY")
            do_auto = false
            do_ptht = true
            return
        end
    end)
    AddCallback("AutoBan","OnVarlist",function(varlist,packet)
        if varlist[0]:find("OnSpawn") then
            name = varlist[1]:match("name|`.(%a+)``")
            SendPacket(2,"action|input\n|text|/ban /"..name)
        end
    end)
    AddCallback("CONSUMABLE","OnVarlist",function (varlist,packet)
        if varlist[0]:find("OnConsoleMessage") and varlist[1]:find("mod removed") then
            local mod = varlist[1]:match('%(`$(.+)%s``mod removed%)')
            if mod == 'Food: Breaking Gems' then
                Place(math.floor(GetLocal().pos_x / 32),math.floor(GetLocal().pos_y / 32),4604)
            elseif mod == 'Lucky!' then
                Place(math.floor(GetLocal().pos_x / 32),math.floor(GetLocal().pos_y / 32),528)
            end
        end
    end)
    AddCallback("GetWeared","OnVarlist",function (v,p)
        if v[0]:find("OnDialogRequest") and v[1]:find("Active effects") then
            if getWear then
                if item_break == 13826 and v[1]:find("`wLegendary Powers``") then
                    item_break_weared = true
                    return true
                elseif item_break == 13862 and v[1]:find("`wMythical Powers``") then
                    item_break_weared = true
                    return true
                elseif item_break == 5480 and v[1]:find("`wRayman's Fists!``") then
                    item_break_weared = true
                    return true
                else
                    item_break_weared = false
                    return true
                end
            else
                if item_ptht == 13826 and v[1]:find("`wLegendary Powers``") then
                    item_harvest_weared = true
                    return true
                elseif item_ptht == 13862 and v[1]:find("`wMythical Powers``") then
                    item_harvest_weared = true
                    return true
                elseif item_ptht == 5480 and v[1]:find("`wRayman's Fists!``") then
                    item_harvest_weared = true
                    return true
                else
                    item_harvest_weared = false
                    return true
                end
            end
            return true
        end
    end)
    if GetLocal().world ~= string.upper(world_auto) then
        SendPacket(3,"action|join_request\nname|"..world_auto.."\ninvitedWorld|0\n")
        Sleep(5000)
    end
    for _,tile in pairs(GetTiles()) do
        if tile.pos_x > 100 then
            world_200x200 = true
            log("WORLD ISLAND DETECTED")
            break
        end
    end
    local tiles = world_200x200 and {width = 199, height = 193} or {width = 99, height = 53}
    for y = 0, tiles.height do
        for x = 0, tiles.width do
            local tile = GetTile(x,y)
            if tile.fg ~= 8 then
                tilecount = tilecount + 1
            end
        end
    end
    warn("SCRIPT EXECUTED")
    Sleep(3000)
    warn("`cYou need atleast `2"..tilecount.."`c Stock seed to avoid `4ERROR") 
    EditToggle("modfly", true)
    Sleep(1000)
    while true do
        if count_tiles(id_farmable,true) > 0 then
            SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autofarm|0\ncheck_autoplace|0")
            reconnect_type = 0
            do_auto = false
            do_ptht = false
            getWear = false
            Sleep(1000)
            SendPacket(2,"action|wrench\n|netid|"..GetLocal().netid)
            Sleep(2000)
            if not item_harvest_weared then
                Wear(item_ptht)
            end
            Sleep(500)
            if item_break == 13862 then
                SendPacket(2,"action|dialog_return\ndialog_name|info_box\nmray_1hit|0\n")
            end
            Sleep(500)
            while count_tiles(id_farmable,true) > 0 do
                Recon()
                local tiles = world_200x200 and {width = 199, height = 193} or {width = 99, height = 53}
                for y = 0, tiles.height do
                    for x = 0, tiles.width do
                        local tile = GetTile(x,y)
                        if tile.fg == id_farmable and tile.ready then
                            Recon()
                            FindPath(x,y)
                            callRayman()
                            Sleep(delay_ht)
                            local pos_x, pos_y = GetLocal().pos_x, GetLocal().pos_y
                            Punch(math.floor(pos_x / 32),math.floor(pos_y / 32))
                        end
                    end
                end
                Recon()
                Sleep(500)
            end
            do_auto = true
            do_ptht = false
        end
        if do_auto then
            Sleep(1000)
            reconnect_type = 1
            local mag_pos_x, mag_pos_y
            if world_200x200 then
                if magindex == 1 then
                    mag_pos_x, mag_pos_y = magposX_block_island_1, magposY_block_island_1
                elseif magindex == 2 then
                    mag_pos_x, mag_pos_y = magposX_block_island_2, magposY_block_island_2
                else
                    log("Unexpected value for mag index")
                end
            else
                mag_pos_x, mag_pos_y = magposX_block, magposY_block
            end
            Sleep(2000)
            if GetTile(mag_pos_x, mag_pos_y-1).fg ~= 0 then
                FindPath(mag_pos_x, mag_pos_y-2)
                Sleep(500)
                while GetTile(mag_pos_x, mag_pos_y-1).fg ~= 0 do
                    Punch(mag_pos_x, mag_pos_y-1)
                    Sleep(500)    
                end
            end
            SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autofarm|0\ncheck_autoplace|0")
            Sleep(500)
            FindPath(mag_pos_x, mag_pos_y-1)
            Sleep(500)
            Wrench(mag_pos_x, mag_pos_y)
            Sleep(500)
            SendPacket(2, "action|dialog_return\ndialog_name|magplant_edit\nx|"..mag_pos_x.."|\ny|"..mag_pos_y.."|\nbuttonClicked|getRemote\n")
            Sleep(500)
            FindPath(pos_break_x,pos_break_y)
            getWear = true
            Sleep(1000)
            SendPacket(2,"action|wrench\n|netid|"..GetLocal().netid)
            Sleep(1000)
            if not item_break_weared then
                Wear(item_break)
            end
            Sleep(500)
            if mray_autobreak_1hit and item_break == 13862 then
                SendPacket(2,"action|dialog_return\ndialog_name|info_box\nmray_1hit|1\n")
            end
            Sleep(500)
            SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autofarm|1\ncheck_bfg|1\ncheck_gems|"..collect_gems)
            Sleep(500)
            Place(math.floor(GetLocal().pos_x / 32),math.floor(GetLocal().pos_y / 32),528)
            Sleep(1000)
            Place(math.floor(GetLocal().pos_x / 32),math.floor(GetLocal().pos_y / 32),4604)
            Sleep(1000)
            do_auto = false
        end
        Sleep(5000)
        if do_ptht then
            reconnect_type = 0
            SendPacket(2,"action|dialog_return\ndialog_name|social\nbuttonClicked|bgem_suckall\n")
            Sleep(500)
            SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autofarm|0\ncheck_bfg|0\ncheck_gems|0")
            getWear = false
            Sleep(1000)
            SendPacket(2,"action|wrench\n|netid|"..GetLocal().netid)
            Sleep(1000)
            if not item_harvest_weared then
                Wear(item_ptht)
            end
            Sleep(1000)
            if item_break == 13862 then
                SendPacket(2,"action|dialog_return\ndialog_name|info_box\nmray_1hit|0\n")
            end
            Sleep(500)
            FindPath(magposX_seed,magposY_seed-1)
            Sleep(500)
            Wrench(magposX_seed,magposY_seed)
            Sleep(500)
            SendPacket(2,"action|dialog_return\ndialog_name|magplant_edit\nx|"..magposX_seed.."|\ny|"..magposY_seed.."|\nbuttonClicked|getRemote\n")
            Sleep(500)
            FindPath(1,0)
            Sleep(500)
            Place(1,0, 5640)
            Sleep(500)
            SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autoplace|1")
            Sleep(500)
            while count_tiles2(0) > 0 do
                Recon()
                local tiles = world_200x200 and {width = 200, height = 200} or {width = 100, height = 60}
                for y = 0, tiles.height - 1 do
                    if y % 2 == 0 then
                        a = 0; b = tiles.width - 1; c = 1
                    else
                        a = tiles.width - 1; b = 0; c = -1
                    end
                    for x = a, b, c do
                        local tile = GetTile(x,y)
                        if tile.fg == 0 then
                            if c == -1 and side ~= "left" then
                                faceSide("left")
                                side = "left"
                            elseif c == 1 and side ~= "right" then
                                faceSide("right")
                                side = "right"
                            end
                            Recon()
                            FindPath(x,y)
                            Sleep(delay_pt)
                            local pos_x, pos_y = GetLocal().pos_x, GetLocal().pos_y
                            Place(math.floor(pos_x / 32), math.floor(pos_y / 32), 5640)
                        end
                    end
                end
                Recon()
                Sleep(500)
            end
            SendPacket(2,"action|dialog_return\ndialog_name|cheats\ncheck_autofarm|0\ncheck_autoplace|0")
            Sleep(1000)
            SendPacket(2,"action|dialog_return\ndialog_name|ultraworldspray")
            Sleep(3000)
            while count_tiles(id_farmable,true) > 0 do
                Recon()
                local tiles = world_200x200 and {width = 199, height = 193} or {width = 99, height = 53}
                for y = 0, tiles.height do
                    for x = 0, tiles.width do
                        local tile = GetTile(x,y)
                        if tile.fg == id_farmable and tile.ready then
                            Recon()
                            FindPath(x,y)
                            callRayman()
                            Sleep(delay_ht)
                            local pos_x, pos_y = GetLocal().pos_x, GetLocal().pos_y
                            Punch(math.floor(pos_x / 32),math.floor(pos_y / 32))
                        end
                    end
                end
                Recon()
                Sleep(500)
            end
            do_auto = true
            do_ptht = false
            getWear = true
            Sleep(1000)
            SendPacket(2,"action|wrench\n|netid|"..GetLocal().netid)
            Sleep(2000)
            if not item_break_weared then
                Wear(item_break)
            end
        end
        Sleep(5000)
        Recon()
    end
else
local warn_dialog = [[add_label_with_icon|small|Daily Script|left|7188|
add_spacer|medium|
add_smalltext|`4WARNING`` : `wYou dont have access to this script, click button bellow to buy``|left|482|
add_spacer|smal|
add_url_button||`cDiscord : `0DailyProfit|NOFLAGS|https://discord.gg/FDyj7Kbx7z|Open Link Discord DailyProfit ?|0|0|
add_spacer|smal|
add_smalltext|Copyright Dailybgl 2023|
end_dialog|daily|Ok!||
]]
local var = {}
var[0] = "OnDialogRequest"
var[1] = warn_dialog
var.netid = -1
SendVarlist(var)
end
